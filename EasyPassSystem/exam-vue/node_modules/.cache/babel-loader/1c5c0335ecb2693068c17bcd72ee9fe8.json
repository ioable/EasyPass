{"remainingRequest":"D:\\BaiduDownload\\projectmass\\exam-vue\\node_modules\\babel-loader\\lib\\index.js!D:\\BaiduDownload\\projectmass\\exam-vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\BaiduDownload\\projectmass\\exam-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\BaiduDownload\\projectmass\\exam-vue\\src\\views\\teacher\\MarkManage.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\BaiduDownload\\projectmass\\exam-vue\\src\\views\\teacher\\MarkManage.vue","mtime":1682044119000},{"path":"D:\\BaiduDownload\\projectmass\\exam-vue\\babel.config.js","mtime":1682044119000},{"path":"D:\\BaiduDownload\\projectmass\\exam-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686540617114},{"path":"D:\\BaiduDownload\\projectmass\\exam-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1686540617613},{"path":"D:\\BaiduDownload\\projectmass\\exam-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686540617114},{"path":"D:\\BaiduDownload\\projectmass\\exam-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1686540616128}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBleGFtIGZyb20gJ0AvYXBpL2V4YW0nOwppbXBvcnQgdXNlciBmcm9tICdAL2FwaS91c2VyJzsKaW1wb3J0IGNvbnN0YW50cyBmcm9tICdAL3V0aWxzL2NvbnN0YW50cyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnTWFya01hbmFnZScsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHF1ZXJ5SW5mbzogewogICAgICAgIHBhZ2VObzogMSwKICAgICAgICBwYWdlU2l6ZTogMTAKICAgICAgfSwKICAgICAgLy/ogIPor5XorrDlvZUKICAgICAgZXhhbVJlY29yZHM6IFtdLAogICAgICAvL+ihqOagvOaVsOaNruWKoOi9vQogICAgICBsb2FkaW5nOiB0cnVlLAogICAgICAvL+aJgOacieiAg+ivleS/oeaBrwogICAgICBhbGxFeGFtSW5mbzogW10sCiAgICAgIC8v5oC75pWwCiAgICAgIHRvdGFsOiAwCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0RXhhbVJlY29yZHMoKTsKICAgIHRoaXMuZ2V0QWxsRXhhbUluZm8oKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGdldEV4YW1SZWNvcmRzKCkgewogICAgICBhd2FpdCBleGFtLmdldEV4YW1SZWNvcmQodGhpcy5xdWVyeUluZm8pLnRoZW4oYXN5bmMgcmVzcCA9PiB7CiAgICAgICAgaWYgKHJlc3AuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICBhd2FpdCB0aGlzLmdldEFsbEV4YW1JbmZvKCk7CiAgICAgICAgICBsZXQgdXNlcklkcyA9IFtdOwogICAgICAgICAgcmVzcC5kYXRhLmRhdGEuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgICAgaWYgKHVzZXJJZHMuZXZlcnkoaWQgPT4gaWQgIT09IGl0ZW0udXNlcklkKSkgewogICAgICAgICAgICAgIHVzZXJJZHMucHVzaChpdGVtLnVzZXJJZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgbGV0IHVzZXJJbmZvID0gW107CiAgICAgICAgICBhd2FpdCB1c2VyLmdldFVzZXJCeUlkcyh7CiAgICAgICAgICAgICd1c2VySWRzJzogdXNlcklkcy5qb2luKCcsJykKICAgICAgICAgIH0pLnRoZW4ocmVzcCA9PiB7CiAgICAgICAgICAgIGlmIChyZXNwLmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgIHVzZXJJbmZvID0gcmVzcC5kYXRhOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHJlc3AuZGF0YS5kYXRhLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRVc2VySW5mbyA9IHVzZXJJbmZvLmZpbmQodSA9PiB1LmlkID09PSBpdGVtLnVzZXJJZCk7CiAgICAgICAgICAgIGl0ZW0udHJ1ZU5hbWUgPSBjdXJyZW50VXNlckluZm8gPT09IG51bGwgfHwgY3VycmVudFVzZXJJbmZvID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjdXJyZW50VXNlckluZm8udHJ1ZU5hbWU7CiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuZXhhbVJlY29yZHMgPSByZXNwLmRhdGEuZGF0YTsKICAgICAgICAgIC8vIOW9k2V4YW1SZWNvcmRz5ZKMZXhhbUluZm/lh4blpIflpb3kuYvlkI7lpITnkIYKICAgICAgICAgIHRoaXMuc2V0RXhhbU5hbWUoKTsKICAgICAgICAgIHRoaXMudG90YWwgPSByZXNwLmRhdGEudG90YWw7CiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGdldEFsbEV4YW1JbmZvKCkgewogICAgICBleGFtLmFsbEV4YW1JbmZvKCkudGhlbihyZXNwID0+IHsKICAgICAgICBpZiAocmVzcC5jb2RlID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuYWxsRXhhbUluZm8gPSByZXNwLmRhdGE7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBvcGVyYXRpb24odikgewogICAgICBpZiAodiA9PT0gJycpIHRoaXMucXVlcnlJbmZvLmV4YW1JZCA9IG51bGw7CiAgICAgIHRoaXMuZ2V0RXhhbVJlY29yZHMoKTsKICAgIH0sCiAgICBzZXRFeGFtTmFtZSgpIHsKICAgICAgdGhpcy5leGFtUmVjb3Jkcy5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgIHRoaXMuYWxsRXhhbUluZm8uZm9yRWFjaChpMiA9PiB7CiAgICAgICAgICBpZiAoaXRlbS5leGFtSWQgPT09IGkyLmV4YW1JZCkgewogICAgICAgICAgICB0aGlzLiRzZXQoaXRlbSwgJ2V4YW1OYW1lJywgaTIuZXhhbU5hbWUpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGlmICghaXRlbS5leGFtTmFtZSkgewogICAgICAgICAgdGhpcy4kc2V0KGl0ZW0sICdleGFtTmFtZScsIGNvbnN0YW50cy5kZWZhdWx0RXhhbU5hbWUpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy/liIbpobXpobXpnaLlpKflsI/mlLnlj5gKICAgIGhhbmRsZVNpemVDaGFuZ2UodmFsKSB7CiAgICAgIHRoaXMucXVlcnlJbmZvLnBhZ2VTaXplID0gdmFsOwogICAgICB0aGlzLmdldEV4YW1SZWNvcmRzKCk7CiAgICB9LAogICAgLy/liIbpobXmj5Lku7bnmoTpobXmlbAKICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UodmFsKSB7CiAgICAgIHRoaXMucXVlcnlJbmZvLnBhZ2VObyA9IHZhbDsKICAgICAgdGhpcy5nZXRFeGFtUmVjb3JkcygpOwogICAgfSwKICAgIC8v5qOA5p+l5om56ZiF5oyJ6ZKu5piv5ZCm5bGV56S6CiAgICBjaGVja01hcmtCdXR0b25OZWVkU2hvdyhyZWNvcmQpIHsKICAgICAgcmV0dXJuIHJlY29yZC50b3RhbFNjb3JlID09PSBudWxsICYmIHRoaXMuYWxsRXhhbUluZm8ubWFwKGV4YW1JbmZvID0+IGV4YW1JbmZvLmV4YW1JZCkuaW5jbHVkZXMocmVjb3JkLmV4YW1JZCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["exam","user","constants","name","data","queryInfo","pageNo","pageSize","examRecords","loading","allExamInfo","total","created","getExamRecords","getAllExamInfo","methods","getExamRecord","then","resp","code","userIds","forEach","item","every","id","userId","push","userInfo","getUserByIds","join","currentUserInfo","find","u","trueName","setExamName","operation","v","examId","i2","$set","examName","defaultExamName","handleSizeChange","val","handleCurrentChange","checkMarkButtonNeedShow","record","totalScore","map","examInfo","includes"],"sources":["src/views/teacher/MarkManage.vue"],"sourcesContent":["<template>\n  <el-container>\n    <el-header>\n      <!--操作的下拉框-->\n      <el-select @change=\"operation\" clearable v-model=\"queryInfo.examId\"\n                 placeholder=\"请选择考试\" style=\"margin-bottom: 25px;\">\n        <el-option v-for=\"(item,index) in allExamInfo\" :key=\"index\" :label=\"item.examName\"\n                   :value=\"parseInt(item.examId)\">\n          <span style=\"float: left\">{{ item.examName }}</span>\n        </el-option>\n      </el-select>\n\n    </el-header>\n\n    <el-main>\n      <el-table\n        ref=\"questionTable\"\n        highlight-current-row\n        v-loading=\"loading\"\n        :border=\"true\"\n        :data=\"examRecords\"\n        tooltip-effect=\"dark\"\n        style=\"width: 100%;\">\n\n        <el-table-column align=\"center\" prop=\"examName\" label=\"考试名称\"></el-table-column>\n\n        <el-table-column align=\"center\" prop=\"examTime\" label=\"参考时间\"></el-table-column>\n\n        <el-table-column align=\"center\" prop=\"trueName\" label=\"参考人\"></el-table-column>\n\n        <el-table-column align=\"center\" prop=\"logicScore\" label=\"逻辑题得分\"></el-table-column>\n\n        <el-table-column align=\"center\" label=\"是否批阅\">\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.totalScore === null ? '未批阅' : '已批阅' }}</span>\n          </template>\n        </el-table-column>\n\n        <el-table-column align=\"center\" label=\"总分\">\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.totalScore === null ? 0 : scope.row.totalScore }}</span>\n          </template>\n        </el-table-column>\n\n        <el-table-column align=\"center\" label=\"操作\">\n          <template slot-scope=\"scope\">\n            <el-button :type=\"checkMarkButtonNeedShow(scope.row) ? 'primary' : 'warning'\" icon=\"el-icon-view\" size=\"small\"\n                       :disabled=\"!checkMarkButtonNeedShow(scope.row)\"\n                       @click=\"$router.push('/markExam/' + scope.row.recordId)\">\n              {{ checkMarkButtonNeedShow(scope.row) ? '批阅' : '已批阅' }}\n            </el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <!--分页-->\n      <el-pagination style=\"margin-top: 25px\"\n                     @size-change=\"handleSizeChange\"\n                     @current-change=\"handleCurrentChange\"\n                     :current-page=\"queryInfo.pageNo\"\n                     :page-sizes=\"[10, 20, 30, 50]\"\n                     :page-size=\"queryInfo.pageSize\"\n                     layout=\"total, sizes, prev, pager, next, jumper\"\n                     :total=\"total\">\n      </el-pagination>\n    </el-main>\n  </el-container>\n</template>\n\n<script>\nimport exam from '@/api/exam'\nimport user from '@/api/user'\nimport constants from '@/utils/constants'\n\nexport default {\n  name: 'MarkManage',\n  data() {\n    return {\n      queryInfo: {\n        pageNo: 1,\n        pageSize: 10\n      },\n      //考试记录\n      examRecords: [],\n      //表格数据加载\n      loading: true,\n      //所有考试信息\n      allExamInfo: [],\n      //总数\n      total: 0\n    }\n  },\n  created() {\n    this.getExamRecords()\n    this.getAllExamInfo()\n  },\n  methods: {\n    async getExamRecords() {\n      await exam.getExamRecord(this.queryInfo).then(async resp => {\n        if (resp.code === 200) {\n          await this.getAllExamInfo()\n          let userIds = []\n          resp.data.data.forEach(item => {\n            if (userIds.every(id => id !== item.userId)) {\n              userIds.push(item.userId)\n            }\n          })\n          let userInfo = []\n          await user.getUserByIds({'userIds': userIds.join(',')}).then(resp => {\n            if (resp.code === 200) {\n              userInfo = resp.data\n            }\n          })\n          resp.data.data.forEach(item => {\n            const currentUserInfo = userInfo.find(u => u.id === item.userId)\n            item.trueName = currentUserInfo?.trueName\n          })\n          this.examRecords = resp.data.data\n          // 当examRecords和examInfo准备好之后处理\n          this.setExamName()\n          this.total = resp.data.total\n          this.loading = false\n        }\n      })\n    },\n    getAllExamInfo() {\n      exam.allExamInfo().then((resp) => {\n        if (resp.code === 200) {\n          this.allExamInfo = resp.data\n        }\n      })\n    },\n    operation(v) {\n      if (v === '') this.queryInfo.examId = null\n      this.getExamRecords()\n    },\n    setExamName() {\n      this.examRecords.forEach(item => {\n        this.allExamInfo.forEach(i2 => {\n          if (item.examId === i2.examId) {\n            this.$set(item, 'examName', i2.examName)\n          }\n        })\n        if (!item.examName) {\n          this.$set(item, 'examName', constants.defaultExamName)\n        }\n      })\n    },\n    //分页页面大小改变\n    handleSizeChange(val) {\n      this.queryInfo.pageSize = val\n      this.getExamRecords()\n    },\n    //分页插件的页数\n    handleCurrentChange(val) {\n      this.queryInfo.pageNo = val\n      this.getExamRecords()\n    },\n    //检查批阅按钮是否展示\n    checkMarkButtonNeedShow(record) {\n      return record.totalScore === null && this.allExamInfo\n        .map(examInfo => examInfo.examId)\n        .includes(record.examId)\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n@import \"../../assets/css/teacher/markManage\";\n</style>\n"],"mappings":";AAsEA,OAAAA,IAAA;AACA,OAAAC,IAAA;AACA,OAAAC,SAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,SAAA;QACAC,MAAA;QACAC,QAAA;MACA;MACA;MACAC,WAAA;MACA;MACAC,OAAA;MACA;MACAC,WAAA;MACA;MACAC,KAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,cAAA;IACA,KAAAC,cAAA;EACA;EACAC,OAAA;IACA,MAAAF,eAAA;MACA,MAAAb,IAAA,CAAAgB,aAAA,MAAAX,SAAA,EAAAY,IAAA,OAAAC,IAAA;QACA,IAAAA,IAAA,CAAAC,IAAA;UACA,WAAAL,cAAA;UACA,IAAAM,OAAA;UACAF,IAAA,CAAAd,IAAA,CAAAA,IAAA,CAAAiB,OAAA,CAAAC,IAAA;YACA,IAAAF,OAAA,CAAAG,KAAA,CAAAC,EAAA,IAAAA,EAAA,KAAAF,IAAA,CAAAG,MAAA;cACAL,OAAA,CAAAM,IAAA,CAAAJ,IAAA,CAAAG,MAAA;YACA;UACA;UACA,IAAAE,QAAA;UACA,MAAA1B,IAAA,CAAA2B,YAAA;YAAA,WAAAR,OAAA,CAAAS,IAAA;UAAA,GAAAZ,IAAA,CAAAC,IAAA;YACA,IAAAA,IAAA,CAAAC,IAAA;cACAQ,QAAA,GAAAT,IAAA,CAAAd,IAAA;YACA;UACA;UACAc,IAAA,CAAAd,IAAA,CAAAA,IAAA,CAAAiB,OAAA,CAAAC,IAAA;YACA,MAAAQ,eAAA,GAAAH,QAAA,CAAAI,IAAA,CAAAC,CAAA,IAAAA,CAAA,CAAAR,EAAA,KAAAF,IAAA,CAAAG,MAAA;YACAH,IAAA,CAAAW,QAAA,GAAAH,eAAA,aAAAA,eAAA,uBAAAA,eAAA,CAAAG,QAAA;UACA;UACA,KAAAzB,WAAA,GAAAU,IAAA,CAAAd,IAAA,CAAAA,IAAA;UACA;UACA,KAAA8B,WAAA;UACA,KAAAvB,KAAA,GAAAO,IAAA,CAAAd,IAAA,CAAAO,KAAA;UACA,KAAAF,OAAA;QACA;MACA;IACA;IACAK,eAAA;MACAd,IAAA,CAAAU,WAAA,GAAAO,IAAA,CAAAC,IAAA;QACA,IAAAA,IAAA,CAAAC,IAAA;UACA,KAAAT,WAAA,GAAAQ,IAAA,CAAAd,IAAA;QACA;MACA;IACA;IACA+B,UAAAC,CAAA;MACA,IAAAA,CAAA,cAAA/B,SAAA,CAAAgC,MAAA;MACA,KAAAxB,cAAA;IACA;IACAqB,YAAA;MACA,KAAA1B,WAAA,CAAAa,OAAA,CAAAC,IAAA;QACA,KAAAZ,WAAA,CAAAW,OAAA,CAAAiB,EAAA;UACA,IAAAhB,IAAA,CAAAe,MAAA,KAAAC,EAAA,CAAAD,MAAA;YACA,KAAAE,IAAA,CAAAjB,IAAA,cAAAgB,EAAA,CAAAE,QAAA;UACA;QACA;QACA,KAAAlB,IAAA,CAAAkB,QAAA;UACA,KAAAD,IAAA,CAAAjB,IAAA,cAAApB,SAAA,CAAAuC,eAAA;QACA;MACA;IACA;IACA;IACAC,iBAAAC,GAAA;MACA,KAAAtC,SAAA,CAAAE,QAAA,GAAAoC,GAAA;MACA,KAAA9B,cAAA;IACA;IACA;IACA+B,oBAAAD,GAAA;MACA,KAAAtC,SAAA,CAAAC,MAAA,GAAAqC,GAAA;MACA,KAAA9B,cAAA;IACA;IACA;IACAgC,wBAAAC,MAAA;MACA,OAAAA,MAAA,CAAAC,UAAA,kBAAArC,WAAA,CACAsC,GAAA,CAAAC,QAAA,IAAAA,QAAA,CAAAZ,MAAA,EACAa,QAAA,CAAAJ,MAAA,CAAAT,MAAA;IACA;EACA;AACA"}]}