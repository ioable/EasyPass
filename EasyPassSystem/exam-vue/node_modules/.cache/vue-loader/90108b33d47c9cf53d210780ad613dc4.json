{"remainingRequest":"C:\\Users\\iyunk\\Desktop\\桌面垃圾\\exam_system-master (2)\\exam-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\iyunk\\Desktop\\桌面垃圾\\exam_system-master (2)\\exam-vue\\src\\views\\teacher\\MarkManage.vue?vue&type=style&index=0&id=6b902f19&scoped=true&lang=scss&","dependencies":[{"path":"C:\\Users\\iyunk\\Desktop\\桌面垃圾\\exam_system-master (2)\\exam-vue\\src\\views\\teacher\\MarkManage.vue","mtime":1682044119000},{"path":"C:\\Users\\iyunk\\Desktop\\桌面垃圾\\exam_system-master (2)\\exam-vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1686540615826},{"path":"C:\\Users\\iyunk\\Desktop\\桌面垃圾\\exam_system-master (2)\\exam-vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1686540617334},{"path":"C:\\Users\\iyunk\\Desktop\\桌面垃圾\\exam_system-master (2)\\exam-vue\\node_modules\\postcss-loader\\src\\index.js","mtime":1686540615808},{"path":"C:\\Users\\iyunk\\Desktop\\桌面垃圾\\exam_system-master (2)\\exam-vue\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1686540610040},{"path":"C:\\Users\\iyunk\\Desktop\\桌面垃圾\\exam_system-master (2)\\exam-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686540617114},{"path":"C:\\Users\\iyunk\\Desktop\\桌面垃圾\\exam_system-master (2)\\exam-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1686540616128}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CkBpbXBvcnQgIi4uLy4uL2Fzc2V0cy9jc3MvdGVhY2hlci9tYXJrTWFuYWdlIjsK"},{"version":3,"sources":["MarkManage.vue"],"names":[],"mappings":";AAyKA","file":"MarkManage.vue","sourceRoot":"src/views/teacher","sourcesContent":["<template>\n  <el-container>\n    <el-header>\n      <!--操作的下拉框-->\n      <el-select @change=\"operation\" clearable v-model=\"queryInfo.examId\"\n                 placeholder=\"请选择考试\" style=\"margin-bottom: 25px;\">\n        <el-option v-for=\"(item,index) in allExamInfo\" :key=\"index\" :label=\"item.examName\"\n                   :value=\"parseInt(item.examId)\">\n          <span style=\"float: left\">{{ item.examName }}</span>\n        </el-option>\n      </el-select>\n\n    </el-header>\n\n    <el-main>\n      <el-table\n        ref=\"questionTable\"\n        highlight-current-row\n        v-loading=\"loading\"\n        :border=\"true\"\n        :data=\"examRecords\"\n        tooltip-effect=\"dark\"\n        style=\"width: 100%;\">\n\n        <el-table-column align=\"center\" prop=\"examName\" label=\"考试名称\"></el-table-column>\n\n        <el-table-column align=\"center\" prop=\"examTime\" label=\"参考时间\"></el-table-column>\n\n        <el-table-column align=\"center\" prop=\"trueName\" label=\"参考人\"></el-table-column>\n\n        <el-table-column align=\"center\" prop=\"logicScore\" label=\"逻辑题得分\"></el-table-column>\n\n        <el-table-column align=\"center\" label=\"是否批阅\">\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.totalScore === null ? '未批阅' : '已批阅' }}</span>\n          </template>\n        </el-table-column>\n\n        <el-table-column align=\"center\" label=\"总分\">\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.totalScore === null ? 0 : scope.row.totalScore }}</span>\n          </template>\n        </el-table-column>\n\n        <el-table-column align=\"center\" label=\"操作\">\n          <template slot-scope=\"scope\">\n            <el-button :type=\"checkMarkButtonNeedShow(scope.row) ? 'primary' : 'warning'\" icon=\"el-icon-view\" size=\"small\"\n                       :disabled=\"!checkMarkButtonNeedShow(scope.row)\"\n                       @click=\"$router.push('/markExam/' + scope.row.recordId)\">\n              {{ checkMarkButtonNeedShow(scope.row) ? '批阅' : '已批阅' }}\n            </el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <!--分页-->\n      <el-pagination style=\"margin-top: 25px\"\n                     @size-change=\"handleSizeChange\"\n                     @current-change=\"handleCurrentChange\"\n                     :current-page=\"queryInfo.pageNo\"\n                     :page-sizes=\"[10, 20, 30, 50]\"\n                     :page-size=\"queryInfo.pageSize\"\n                     layout=\"total, sizes, prev, pager, next, jumper\"\n                     :total=\"total\">\n      </el-pagination>\n    </el-main>\n  </el-container>\n</template>\n\n<script>\nimport exam from '@/api/exam'\nimport user from '@/api/user'\nimport constants from '@/utils/constants'\n\nexport default {\n  name: 'MarkManage',\n  data() {\n    return {\n      queryInfo: {\n        pageNo: 1,\n        pageSize: 10\n      },\n      //考试记录\n      examRecords: [],\n      //表格数据加载\n      loading: true,\n      //所有考试信息\n      allExamInfo: [],\n      //总数\n      total: 0\n    }\n  },\n  created() {\n    this.getExamRecords()\n    this.getAllExamInfo()\n  },\n  methods: {\n    async getExamRecords() {\n      await exam.getExamRecord(this.queryInfo).then(async resp => {\n        if (resp.code === 200) {\n          await this.getAllExamInfo()\n          let userIds = []\n          resp.data.data.forEach(item => {\n            if (userIds.every(id => id !== item.userId)) {\n              userIds.push(item.userId)\n            }\n          })\n          let userInfo = []\n          await user.getUserByIds({'userIds': userIds.join(',')}).then(resp => {\n            if (resp.code === 200) {\n              userInfo = resp.data\n            }\n          })\n          resp.data.data.forEach(item => {\n            const currentUserInfo = userInfo.find(u => u.id === item.userId)\n            item.trueName = currentUserInfo?.trueName\n          })\n          this.examRecords = resp.data.data\n          // 当examRecords和examInfo准备好之后处理\n          this.setExamName()\n          this.total = resp.data.total\n          this.loading = false\n        }\n      })\n    },\n    getAllExamInfo() {\n      exam.allExamInfo().then((resp) => {\n        if (resp.code === 200) {\n          this.allExamInfo = resp.data\n        }\n      })\n    },\n    operation(v) {\n      if (v === '') this.queryInfo.examId = null\n      this.getExamRecords()\n    },\n    setExamName() {\n      this.examRecords.forEach(item => {\n        this.allExamInfo.forEach(i2 => {\n          if (item.examId === i2.examId) {\n            this.$set(item, 'examName', i2.examName)\n          }\n        })\n        if (!item.examName) {\n          this.$set(item, 'examName', constants.defaultExamName)\n        }\n      })\n    },\n    //分页页面大小改变\n    handleSizeChange(val) {\n      this.queryInfo.pageSize = val\n      this.getExamRecords()\n    },\n    //分页插件的页数\n    handleCurrentChange(val) {\n      this.queryInfo.pageNo = val\n      this.getExamRecords()\n    },\n    //检查批阅按钮是否展示\n    checkMarkButtonNeedShow(record) {\n      return record.totalScore === null && this.allExamInfo\n        .map(examInfo => examInfo.examId)\n        .includes(record.examId)\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n@import \"../../assets/css/teacher/markManage\";\n</style>\n"]}]}